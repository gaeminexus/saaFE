<div class="consultas-pagos">
  <mat-card>
    <mat-card-title>Consulta · Pagos</mat-card-title>
    <mat-card-content>
      <div class="filters">
        <mat-form-field appearance="outline">
          <mat-label>Fecha inicio</mat-label>
          <input matInput [matDatepicker]="d1" (dateChange)="fechaInicio.set($event.value)" />
          <mat-datepicker-toggle matSuffix [for]="d1"></mat-datepicker-toggle>
          <mat-datepicker #d1></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Fecha fin</mat-label>
          <input matInput [matDatepicker]="d2" (dateChange)="fechaFin.set($event.value)" />
          <mat-datepicker-toggle matSuffix [for]="d2"></mat-datepicker-toggle>
          <mat-datepicker #d2></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full">
          <mat-label>Beneficiario</mat-label>
          <input matInput (input)="beneficiario.set($any($event.target).value)" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Forma de pago</mat-label>
          <mat-select (selectionChange)="formaPago.set($any($event.value))">
            <mat-option [value]="''">Todas</mat-option>
            <mat-option value="EFECTIVO">EFECTIVO</mat-option>
            <mat-option value="CHEQUE">CHEQUE</mat-option>
            <mat-option value="TRANSFERENCIA">TRANSFERENCIA</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Banco</mat-label>
          <input matInput (input)="banco.set($any($event.target).value)" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Cuenta</mat-label>
          <input matInput (input)="cuenta.set($any($event.target).value)" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Estado</mat-label>
          <mat-select (selectionChange)="estado.set($any($event.value))">
            <mat-option [value]="''">Todos</mat-option>
            <mat-option value="REGISTRADO">REGISTRADO</mat-option>
            <mat-option value="APLICADO">APLICADO</mat-option>
            <mat-option value="ANULADO">ANULADO</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="actions">
        <button mat-stroked-button color="basic" (click)="limpiar()">
          <mat-icon>refresh</mat-icon>
          Limpiar filtros
        </button>
      </div>

      <div class="table-wrapper">
        <table mat-table [dataSource]="filtered()" class="mat-elevation-z1 full-width">
          <ng-container matColumnDef="numero">
            <th mat-header-cell *matHeaderCellDef>Número</th>
            <td mat-cell *matCellDef="let r">{{ r.numero }}</td>
          </ng-container>

          <ng-container matColumnDef="beneficiario">
            <th mat-header-cell *matHeaderCellDef>Beneficiario</th>
            <td mat-cell *matCellDef="let r">{{ r.beneficiario }}</td>
          </ng-container>

          <ng-container matColumnDef="forma">
            <th mat-header-cell *matHeaderCellDef>Forma</th>
            <td mat-cell *matCellDef="let r">{{ r.formaPago }}</td>
          </ng-container>

          <ng-container matColumnDef="banco">
            <th mat-header-cell *matHeaderCellDef>Banco</th>
            <td mat-cell *matCellDef="let r">{{ r.banco || '-' }}</td>
          </ng-container>

          <ng-container matColumnDef="cuenta">
            <th mat-header-cell *matHeaderCellDef>Cuenta</th>
            <td mat-cell *matCellDef="let r">{{ r.cuenta || '-' }}</td>
          </ng-container>

          <ng-container matColumnDef="fecha">
            <th mat-header-cell *matHeaderCellDef>Fecha</th>
            <td mat-cell *matCellDef="let r">{{ r.fecha }}</td>
          </ng-container>

          <ng-container matColumnDef="valor">
            <th mat-header-cell *matHeaderCellDef>Valor</th>
            <td mat-cell *matCellDef="let r">{{ r.valor | number : '1.2-2' }}</td>
          </ng-container>

          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let r">{{ r.estado }}</td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="[
              'numero',
              'beneficiario',
              'forma',
              'banco',
              'cuenta',
              'fecha',
              'valor',
              'estado'
            ]"
          ></tr>
          <tr
            mat-row
            *matRowDef="
              let row;
              columns: [
                'numero',
                'beneficiario',
                'forma',
                'banco',
                'cuenta',
                'fecha',
                'valor',
                'estado'
              ]
            "
          ></tr>
        </table>
      </div>

      <div class="totals">
        Registros: <strong>{{ filtered().length }}</strong> — Total:
        <strong>{{ total() | number : '1.2-2' }}</strong>
      </div>
    </mat-card-content>
  </mat-card>
</div>
