<div class="dialog-container">
  <div class="dialog-header">
    <h2 mat-dialog-title>
      <mat-icon>payments</mat-icon>
      Pagos de Cuota #{{ data.detalle.numeroCuota }}
    </h2>
    <button mat-icon-button mat-dialog-close class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content>
    <div class="detalle-info">
      <div class="info-item">
        <span class="label">Vencimiento:</span>
        <span class="value">{{ data.detalle.fechaVencimiento | date: 'dd/MM/yyyy' }}</span>
      </div>
      <div class="info-item">
        <span class="label">Capital:</span>
        <span class="value">{{ data.detalle.capital | currency: 'USD':'symbol':'1.2-2' }}</span>
      </div>
      <div class="info-item">
        <span class="label">Interés:</span>
        <span class="value">{{ data.detalle.interes | currency: 'USD':'symbol':'1.2-2' }}</span>
      </div>
      <div class="info-item">
        <span class="label">Cuota:</span>
        <span class="value">{{ data.detalle.cuota | currency: 'USD':'symbol':'1.2-2' }}</span>
      </div>
      <div class="info-item">
        <span class="label">Saldo:</span>
        <span class="value">{{ data.detalle.saldo | currency: 'USD':'symbol':'1.2-2' }}</span>
      </div>
    </div>

    @if (data.pagos && data.pagos.length > 0) {
      <div class="pagos-section">
        <h3>
          <mat-icon>history</mat-icon>
          Historial de Pagos ({{ data.pagos.length }})
        </h3>
        <table mat-table [dataSource]="data.pagos" class="pagos-table">
          <!-- Fecha Column -->
          <ng-container matColumnDef="fecha">
            <th mat-header-cell *matHeaderCellDef>Fecha</th>
            <td mat-cell *matCellDef="let pago">
              {{ pago.fecha | date: 'dd/MM/yyyy' }}
            </td>
          </ng-container>

          <!-- Capital Pagado Column -->
          <ng-container matColumnDef="capitalPagado">
            <th mat-header-cell *matHeaderCellDef>Capital Pagado</th>
            <td mat-cell *matCellDef="let pago">
              {{ pago.capitalPagado | currency: 'USD':'symbol':'1.2-2' }}
            </td>
          </ng-container>

          <!-- Interés Pagado Column -->
          <ng-container matColumnDef="interesPagado">
            <th mat-header-cell *matHeaderCellDef>Interés Pagado</th>
            <td mat-cell *matCellDef="let pago">
              {{ pago.interesPagado | currency: 'USD':'symbol':'1.2-2' }}
            </td>
          </ng-container>

          <!-- Mora Pagada Column -->
          <ng-container matColumnDef="moraPagada">
            <th mat-header-cell *matHeaderCellDef>Mora Pagada</th>
            <td mat-cell *matCellDef="let pago">
              {{ pago.moraPagada | currency: 'USD':'symbol':'1.2-2' }}
            </td>
          </ng-container>

          <!-- Valor Total Column -->
          <ng-container matColumnDef="valor">
            <th mat-header-cell *matHeaderCellDef>Valor Total</th>
            <td mat-cell *matCellDef="let pago" class="total-column">
              {{ pago.valor | currency: 'USD':'symbol':'1.2-2' }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    } @else {
      <div class="no-pagos">
        <mat-icon>info</mat-icon>
        <p>No se encontraron pagos registrados para esta cuota.</p>
      </div>
    }
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-raised-button mat-dialog-close color="primary">
      <mat-icon>check</mat-icon>
      Cerrar
    </button>
  </mat-dialog-actions>
</div>
