<form [formGroup]="form" (ngSubmit)="onSubmit()" class="naturlaeza-form">
  <div class="form-header">
    <h2>{{ isEditMode ? 'Editar' : 'Nueva' }} Naturaleza de Cuenta</h2>
    <button mat-icon-button type="button" (click)="onCancel()" aria-label="Cerrar">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  @if (error) {
    <div class="error-message">
      <mat-icon>error_outline</mat-icon>
      <span>{{ error }}</span>
    </div>
  }

  <div class="form-body">
    <mat-form-field appearance="outline">
      <mat-label>Nombre</mat-label>
      <input matInput formControlName="nombre" placeholder="Ingrese el nombre">
      @if (form.get('nombre')?.errors?.['required'] && form.get('nombre')?.touched) {
        <mat-error>El nombre es requerido</mat-error>
      }
      @if (form.get('nombre')?.errors?.['minlength']) {
        <mat-error>El nombre debe tener al menos 3 caracteres</mat-error>
      }
      @if (form.get('nombre')?.errors?.['maxlength']) {
        <mat-error>El nombre no puede exceder 100 caracteres</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Número de Cuenta</mat-label>
      <input matInput formControlName="numero" placeholder="Ingrese el número">
      @if (form.get('numero')?.errors?.['required'] && form.get('numero')?.touched) {
        <mat-error>El número de cuenta es requerido</mat-error>
      }
      @if (form.get('numero')?.errors?.['pattern']) {
        <mat-error>Solo se permiten números</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" class="tipo-form-field">
      <mat-label>Tipo de Naturaleza</mat-label>
      <mat-select formControlName="tipo" panelClass="custom-select-panel">
        @for (tipo of tiposNaturaleza; track tipo.value) {
          <mat-option [value]="tipo.value">{{ tipo.label }}</mat-option>
        }
      </mat-select>
      @if (form.get('tipo')?.errors?.['required'] && form.get('tipo')?.touched) {
        <mat-error>El tipo de naturaleza es requerido</mat-error>
      }
    </mat-form-field>

    <div class="form-row">
      <mat-slide-toggle formControlName="manejaCentroCosto" color="primary">
        Maneja Centro de Costos
      </mat-slide-toggle>
    </div>
  </div>

  <div class="form-actions">
    <button mat-button type="button" (click)="onCancel()">Cancelar</button>
    <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid || loading">
      @if (loading) {
        <ng-container>
          <mat-spinner [diameter]="20"></mat-spinner>
          <span>Guardando...</span>
        </ng-container>
      } @else {
        <ng-container>
          <mat-icon>save</mat-icon>
          <span>Guardar</span>
        </ng-container>
      }
    </button>
  </div>
</form>
